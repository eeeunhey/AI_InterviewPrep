
server.jsì— ìˆë˜ ì£¼ì„ì„ í•´ì œí•œë‹¤
app.use("/api/session", sessionRoutes);

ê·¸í›„ sessionRoutes.js ìˆ˜ì •

ì¢‹ìŠµë‹ˆë‹¤ ğŸ‘
ì˜¬ë ¤ì£¼ì‹  ì½”ë“œëŠ” **Express ë¼ìš°í„° ì„¤ì •**ì´ì—ìš”. ì œê°€ í•˜ë‚˜ì”© í•´ì„í•´ë“œë¦´ê²Œìš”.

---

## 1. import ë¶€ë¶„

```js
const express = require('express');
const { createSession, getSessionById, getMySections, deleteSession } = require('../controllers/sessionController');
const { protect } = require('../middlewares/authMiddleware');
```

* `express`: ë¼ìš°íŒ…ì„ í•˜ê¸° ìœ„í•´ ë¶ˆëŸ¬ì˜´.
* `sessionController`: ì„¸ì…˜ ê´€ë ¨ ë¡œì§ì´ ë“¤ì–´ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ (CRUD ê¸°ëŠ¥).

  * `createSession` : ì„¸ì…˜ ìƒì„±
  * `getSessionById` : íŠ¹ì • ID ì„¸ì…˜ ì¡°íšŒ
  * `getMySections` : ë¡œê·¸ì¸í•œ ìœ ì €ì˜ ì„¸ì…˜ë“¤ ì¡°íšŒ
  * `deleteSession` : ì„¸ì…˜ ì‚­ì œ
* `protect`: JWT ì¸ì¦ ë¯¸ë“¤ì›¨ì–´ (ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ê²Œ ë§‰ìŒ).

---
## 2. ë¼ìš°í„° ìƒì„±

```js
const router = express.Router();
```
* `express.Router()`ë¥¼ ì´ìš©í•´ ë¼ìš°í„° ê°ì²´ë¥¼ ìƒì„±.
* ì´í›„ ì—¬ê¸°ì— ê° API ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì •ì˜.

---

## 3. ë¼ìš°íŠ¸ ì •ì˜

```js
router.post('/create', protect, createSession);
```

* **POST /create**
* JWT ì¸ì¦(`protect`) í•„ìš”.
* ìƒˆ ì„¸ì…˜ì„ ìƒì„±í•˜ëŠ” API.

```js
router.get('/my-session', protect, getMySections);
```

* **GET /my-session**
* ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ê°€ì§„ ëª¨ë“  ì„¸ì…˜ ì¡°íšŒ.

```js
router.get('/:id', protect, getSessionById);
```

* **GET /\:id**
* íŠ¹ì • ì„¸ì…˜(`id`) ì¡°íšŒ.
* URL íŒŒë¼ë¯¸í„° ì‚¬ìš© (ì˜ˆ: `/1234` â†’ id=1234).

```js
router.delete('/:id', protect, deleteSession);
```

* **DELETE /\:id**
* íŠ¹ì • ì„¸ì…˜ ì‚­ì œ.

---

## 4. export

```js
module.exports = router;
```

* ì´ ë¼ìš°í„°ë¥¼ ë‹¤ë¥¸ ê³³(`server.js`ë‚˜ `app.js`)ì—ì„œ `app.use('/api/sessions', router)` ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì—°ê²°í•  ìˆ˜ ìˆìŒ.

---

âœ… **ì •ë¦¬**

* `/create` â†’ ì„¸ì…˜ ìƒì„± (POST)
* `/my-session` â†’ ë‚´ ì„¸ì…˜ ëª©ë¡ ì¡°íšŒ (GET)
* `/:id` â†’ ì„¸ì…˜ ìƒì„¸ ì¡°íšŒ (GET)
* `/:id` â†’ ì„¸ì…˜ ì‚­ì œ (DELETE)

-> ë‹¤ ì‘ì„±í–ˆìœ¼ë©´ ì´ì œ SessionController.js ìˆ˜ì •í•˜ì
ìˆœì„œ íë¦„
1. server.js ->app.use("/api/session", sessionRoutes); ë“±ë¡
2. sessionRoutes.js ì„¸ì…˜ ìƒì„±(POST) (ëª©ë¡ / ìƒì„¸) ì¡°íšŒ(GET) ì‚­ì œ(DELECT) ê°€ì ¸ì˜¤ëŠ” í˜•íƒœë¥¼ ëª…ì‹œ
3. SessionController.js ë¥¼ êµ¬í˜„í•œë‹¤ sessionRoutesìˆë˜ ì„¸ë¶€ì ì¸ ì½”ë“œë¥¼ ì‘ì„±
    - createSession êµ¬í˜„í•˜ê¸° ì½”ë“œëŠ” ì•„ë˜ ê¸°ì¬í•¨
4. server.js ë¼ìš°í„°ë¥¼ ì¶”ê°€í•œë‹¤ const sessionRoutes = require('./routes/sessionRoutes')
5. 



### 3.essionController.js_createSession
**ìƒˆë¡œìš´ ì„¸ì…˜ì„ ë§Œë“¤ê³  ê·¸ ì„¸ì…˜ì— ì—°ê²°ëœ ì§ˆë¬¸ë“¤ì„ DBì— ì €ì¥í•˜ëŠ” API ë¡œì§**
---

## 1. ìš”ì²­ ë°ì´í„° êº¼ë‚´ì˜¤ê¸°
```js
const { role, experience, topicsToFocus, description, questions } = req.body;
const userId = req.user._id;
```
* í´ë¼ì´ì–¸íŠ¸(Postman ê°™ì€ ê³³)ì—ì„œ ë³´ë‚¸ JSON Bodyì—ì„œ `role, experience, topicsToFocus, description, questions` ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
* `req.user._id`: protect ë¯¸ë“¤ì›¨ì–´(JWT ì¸ì¦)ì—ì„œ ì„¸íŒ…í•´ë‘” ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ID.
---

## 2. ì„¸ì…˜(Session) ìƒì„±
```js
const session = await Session.create({
  user: userId,
  role,
  experience,
  topicsToFocus,
  description,
});
```
* ìƒˆë¡œìš´ **Session ë¬¸ì„œ**ë¥¼ MongoDBì— ì €ì¥.
* ì—¬ê¸°ì„œëŠ” ì„¸ì…˜ì˜ ê¸°ë³¸ ì •ë³´ë§Œ ì €ì¥ (`role, experience, topicsToFocus, description, user`).
* ì•„ì§ `questions`ëŠ” ë¹„ì–´ ìˆìŒ.

---
## 3. ì§ˆë¬¸(Question) ìƒì„±

```js
const questionDocs = await Promise.all(
  questions.map(async (q) => {
    const question = await Question.create({
      session: session._id,
      question: q.question,
      answer: q.answer,
    });
    return question._id;
  })
);
```
* ìš”ì²­ Bodyì˜ `questions` ë°°ì—´ì„ ìˆœíšŒí•˜ë©´ì„œ ê°ê° DBì— `Question` ë¬¸ì„œë¥¼ ë§Œë“­ë‹ˆë‹¤.
* ê° ì§ˆë¬¸ ë¬¸ì„œì—ëŠ” **ì–´ë–¤ ì„¸ì…˜ì— ì†í•˜ëŠ”ì§€**ë¥¼ ì•Œ ìˆ˜ ìˆë„ë¡ `session: session._id`ë¥¼ ì €ì¥.
* ì§ˆë¬¸ ìƒì„± í›„ ê·¸ ì§ˆë¬¸ì˜ `_id`ë§Œ ë°°ì—´ë¡œ ëª¨ìë‹ˆë‹¤.
* `Promise.all`ì„ ì“°ëŠ” ì´ìœ : ì—¬ëŸ¬ ì§ˆë¬¸ì„ **ë¹„ë™ê¸°ë¡œ ë™ì‹œì— ì €ì¥**í•˜ê¸° ìœ„í•´.
---

## 4. ì„¸ì…˜ì— ì§ˆë¬¸ ì—°ê²°
```js
session.questions = questionDocs;
await session.save();
```
* ì•„ê¹Œ ë§Œë“  ì„¸ì…˜ ë¬¸ì„œì— `questions` í•„ë“œì— ìƒˆë¡œ ë§Œë“  ì§ˆë¬¸ë“¤ì˜ `_id` ë°°ì—´ì„ ë„£ìŠµë‹ˆë‹¤.
* ê·¸ í›„ `session.save()`ë¡œ ì„¸ì…˜ì„ ì—…ë°ì´íŠ¸.

---
## 5. ì‘ë‹µ ë°˜í™˜

```js
res.status(201).json({ success: true, session });
```
* ì„±ê³µ ì‹œ **201 Created** ìƒíƒœì½”ë“œì™€ í•¨ê»˜, ìƒì„±ëœ ì„¸ì…˜ ì •ë³´ë¥¼ ì‘ë‹µìœ¼ë¡œ ë³´ëƒ…ë‹ˆë‹¤.

---
## 6. ì—ëŸ¬ ì²˜ë¦¬
```js
} catch (error) {
  res.status(500).json({ success: false, message: "Server Error" });
}
```
* try ë¸”ë¡ì—ì„œ ë¬¸ì œê°€ ìƒê¸°ë©´ 500 ì—ëŸ¬ë¥¼ ë°˜í™˜.

---
âœ… **ì •ë¦¬**

* ì´ í•¨ìˆ˜ëŠ” **ìƒˆ ì„¸ì…˜ ìƒì„± â†’ ì§ˆë¬¸ë“¤ DBì— ì €ì¥ â†’ ì„¸ì…˜ì— ì§ˆë¬¸ ì—°ê²° â†’ ìµœì¢… ì„¸ì…˜ ë°˜í™˜** ê³¼ì •ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
* DB ê´€ê³„ëŠ” **Session (1) â†” (N) Question** êµ¬ì¡°ì˜ˆìš”.
* `req.user._id` ë•ë¶„ì— "ë¡œê·¸ì¸í•œ ì‚¬ìš©ì"ì™€ ì„¸ì…˜ì„ ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
---

### 3.essionController.js_getMySession
ì¢‹ìŠµë‹ˆë‹¤ ğŸ‘ ì˜¬ë ¤ì£¼ì‹  `getMySessions` í•¨ìˆ˜ëŠ” **ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ë§Œë“  ëª¨ë“  ì„¸ì…˜ì„ ê°€ì ¸ì˜¤ëŠ” API**ì…ë‹ˆë‹¤.
í•˜ë‚˜ì”© í•´ì„í•´ë“œë¦´ê²Œìš”.

---
---



### 3.essionController.js_getMySessions

```js
exports.getMySessions = async (req, res) => {
  try {
    const session = await Session.find({ user: req.user.id }) // ğŸ”¹ í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì„¸ì…˜ë§Œ ì°¾ìŒ
      .sort({ createdAt: -1 })                               // ğŸ”¹ ìµœì‹ ìˆœ ì •ë ¬
      .populate("questions");                                // ğŸ”¹ ì—°ê²°ëœ ì§ˆë¬¸(Question) ë¬¸ì„œë„ í•¨ê»˜ ê°€ì ¸ì˜¤ê¸°

    res.status(200).json(session); // ğŸ”¹ ê²°ê³¼ë¥¼ JSONìœ¼ë¡œ ì‘ë‹µ
  } catch (error) {
    res.status(500).json({ success: false, message: "Server Error" }); // ğŸ”¹ ì—ëŸ¬ ë°œìƒ ì‹œ 500 ì‘ë‹µ
  }
};
```

---

## ë™ì‘ íë¦„

1. `protect` ë¯¸ë“¤ì›¨ì–´ ë•ë¶„ì— `req.user` ì•ˆì— ë¡œê·¸ì¸í•œ ì‚¬ìš©ìì˜ ì •ë³´ê°€ ì´ë¯¸ ìˆìŒ.
   * `req.user.id` â†’ ë¡œê·¸ì¸í•œ ìœ ì €ì˜ MongoDB `_id`

2. `Session.find({ user: req.user.id })`
   * DBì—ì„œ í•´ë‹¹ ìœ ì €ì˜ ì„¸ì…˜ë§Œ ì¡°íšŒ

3. `.sort({ createdAt: -1 })`
   * ìƒì„±ì¼ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ â†’ ìµœì‹  ì„¸ì…˜ì´ ë¨¼ì € ì˜¤ë„ë¡

4. `.populate("questions")`
   * ì„¸ì…˜ì— ì—°ê²°ëœ `questions` ë°°ì—´(ObjectId ì°¸ì¡°)ì„ ì‹¤ì œ `Question` ë¬¸ì„œë“¤ë¡œ ì¹˜í™˜
   * ë”°ë¼ì„œ ì‘ë‹µ JSONì—ëŠ” ì§ˆë¬¸ ë‚´ìš©(`question`, `answer`)ê¹Œì§€ í¬í•¨ë¨

5. `res.status(200).json(session)`
   * ê²°ê³¼ ë°°ì—´ì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ë°˜í™˜

6. ì‹¤íŒ¨ ì‹œ `500 Server Error` ë°˜í™˜

---

## ì‘ë‹µ ì˜ˆì‹œ
ìš”ì²­:
```
GET /api/sessions/my-sessions
Authorization: Bearer <í† í°>
```
ì‘ë‹µ(JSON):
```json
[
  {
    "_id": "64fc123...",
    "user": "64fb999...",
    "role": "Frontend Developer",
    "experience": 2,
    "topicsToFocus": "React, JavaScript, HTML, CSS",
    "description": "Preparing for frontend dev roles",
    "questions": [
      {
        "_id": "64fc456...",
        "session": "64fc123...",
        "question": "What is useState in React?",
        "answer": "useState is a hook that lets you manage state inside functional components...",
        "createdAt": "2025-09-02T08:00:00.000Z"
      },
      {
        "_id": "64fc789...",
        "session": "64fc123...",
        "question": "Explain Virtual DOM in React.",
        "answer": "Virtual DOM is a lightweight copy of the real DOM...",
        "createdAt": "2025-09-02T08:00:00.000Z"
      }
    ],
    "createdAt": "2025-09-02T08:00:00.000Z"
  }
]
---

âœ… ì •ë¦¬:
`getMySessions`ì€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ë§Œë“  ëª¨ë“  ì„¸ì…˜ì„ **ìµœì‹ ìˆœ**ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¤ê³ ,
ê° ì„¸ì…˜ì— ì—°ê²°ëœ ì§ˆë¬¸ë“¤ê¹Œì§€ í•¨ê»˜ ë‚´ë ¤ì£¼ëŠ” API
        .populate("questions")ë¥¼ ì‚¬ìš©í•  ë•Œ
        populateë¥¼ ì“°ë©´ ì € ObjectIdë“¤ì„ ì‹¤ì œ Question ë¬¸ì„œë¡œ ë°”ê¿”ì„œ ë„£ì–´ì¤ë‹ˆë‹¤:

            [
            {
                "_id": "sess123",
                "role": "Frontend Developer",
                "experience": 2,
                "description": "Preparing for frontend dev roles",
                "questions": [
                {
                    "_id": "ques111",
                    "question": "What is useState in React?",
                    "answer": "useState is a hook that lets you manage state inside functional components..."
                },
                {
                    "_id": "ques112",
                    "question": "Explain Virtual DOM in React.",
                    "answer": "Virtual DOM is a lightweight copy of the real DOM..."
                }
                ]
            }
            ]

            í´ë¼ì´ì–¸íŠ¸(í”„ë¡ íŠ¸ì—”ë“œ)ì—ì„œ API ì‘ë‹µë§Œ ë°›ì•„ë„,
            â€œì´ ì„¸ì…˜ì—ëŠ” ì–´ë–¤ ì§ˆë¬¸ê³¼ ë‹µë³€ì´ ìˆëŠ”ì§€â€ ë°”ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŒ

1. ì‘ë‹µ êµ¬ì¡°
[
  {
    "_id": "6819ee2e0fbdf...1faec2",   // ì„¸ì…˜ ID
    "user": "6819ec9404f...a997f16",   // ì„¸ì…˜ì„ ë§Œë“  ì‚¬ìš©ì ID
    "role": "Frontend Developer",      // ì¤€ë¹„í•˜ëŠ” í¬ì§€ì…˜
    "experience": 2,                   // ê²½ë ¥
    "topicsToFocus": "React, JavaScript, HTML, CSS", // ì§‘ì¤‘í•  ì£¼ì œ
    "description": "Preparing for frontend dev roles", // ì„¸ì…˜ ì„¤ëª…
    "questions": [
      {
        "_id": "6819ee2e0fbdf...1faec4",  // ì§ˆë¬¸ ID
        "session": "6819ee2e0fbdf...1faec2", // ì–´ë–¤ ì„¸ì…˜ì— ì†í•œ ì§ˆë¬¸ì¸ì§€
        "question": "What is useState in React?",   // ì§ˆë¬¸ ë‚´ìš©
        "answer": "useState is a hook ...",         // ë‹µë³€ ë‚´ìš©
        "isPinned": false,
        "createdAt": "...",
        "updatedAt": "...",
        "__v": 0
      },
      {
        "_id": "6819ee2e0fbdf...1faec5",
        "session": "6819ee2e0fbdf...1faec2",
        "question": "Explain Virtual DOM in React.",
        "answer": "Virtual DOM is a lightweight copy ...",
        "isPinned": false,
        "createdAt": "...",
        "updatedAt": "...",
        "__v": 0
      }
    ],
    "createdAt": "...",
    "updatedAt": "...",
    "__v": 1
  }
]

2. ì˜ë¯¸

ì„¸ì…˜(Session) ë¬¸ì„œ
role, experience, topicsToFocus, description ë“±ì€ ì„¸ì…˜ì˜ ë©”íƒ€ë°ì´í„°.
user í•„ë“œë¡œ ì´ ì„¸ì…˜ì´ ì–´ëŠ ì‚¬ìš©ìì˜ ê²ƒì¸ì§€ ì•Œ ìˆ˜ ìˆìŒ.

questions í•„ë“œ

ë‹¨ìˆœíˆ ObjectId ë°°ì—´ì´ ì•„ë‹ˆë¼, .populate("questions") ë•ë¶„ì— ì‹¤ì œ Question ë¬¸ì„œ ë‚´ìš©ì´ ë“¤ì–´ì˜´.
ë”°ë¼ì„œ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ API í•œ ë²ˆ í˜¸ì¶œë§Œìœ¼ë¡œ ì§ˆë¬¸ê³¼ ë‹µë³€ê¹Œì§€ í™•ì¸ ê°€ëŠ¥.

ê´€ê³„ í‘œí˜„
Session (1) â†” (N) Question
ì¦‰, ì„¸ì…˜ í•˜ë‚˜ì— ì—¬ëŸ¬ ì§ˆë¬¸ë“¤ì´ ì—°ê²°ë¼ ìˆê³ , ì‘ë‹µì—ì„œ ê°™ì´ ë‚´ë ¤ì˜´.

3. ì‰½ê²Œ ë§í•˜ë©´
"ë‚´ê°€ ë§Œë“  ì¸í„°ë·° ì¤€ë¹„ ì„¸ì…˜"ì„ ê°€ì ¸ì™”ëŠ”ë°,
ê·¸ ì•ˆì— ë“¤ì–´ìˆëŠ” ì—°ê²°ëœ ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸ê¹Œì§€ ê°™ì´ ë¶ˆëŸ¬ì˜¨ ê²ƒì´ì—ìš”.

ì¦‰,
ğŸ‘‰ ë‹¨ìˆœíˆ "ì„¸ì…˜ë§Œ" ê°€ì ¸ì˜¤ëŠ” ê²Œ ì•„ë‹ˆë¼
ğŸ‘‰ "ì„¸ì…˜ + í•´ë‹¹ ì„¸ì…˜ì— ì†í•œ ì§ˆë¬¸ ë°ì´í„°"ë¥¼ í•œ ë²ˆì— í´ë¼ì´ì–¸íŠ¸ë¡œ ë‚´ë ¤ì£¼ëŠ” êµ¬ì¡°ì…ë‹ˆë‹¤.

---
---

### 3.essionController.js_getSessionById
ì„¸ì…˜ IDë¡œ íŠ¹ì • ì„¸ì…˜ì„ ê°€ì ¸ì˜¤ê³ , ê·¸ ì„¸ì…˜ì— ì—°ê²°ëœ ì§ˆë¬¸ë“¤ê¹Œì§€ í•¨ê»˜ ê°€ì ¸ì˜¤ëŠ” API ì»¨íŠ¸ë¡¤ëŸ¬

1. íŠ¹ì • ì„¸ì…˜ ì°¾ê¸°
const session = await Session.findById(req.params.id)
  .populate({
    path: "questions",
    options: { sort: { isPinned: -1, createAt: 1} },
  })
  .exec();


req.params.id â†’ URLì—ì„œ ì „ë‹¬ëœ ì„¸ì…˜ ID (ì˜ˆ: /api/sessions/12345)

Session.findById(...) â†’ í•´ë‹¹ ì„¸ì…˜ì„ MongoDBì—ì„œ ì¡°íšŒ

.populate({ path: "questions", ... }) â†’ ì„¸ì…˜ì— ì—°ê²°ëœ ì§ˆë¬¸ ë¬¸ì„œë“¤ì„ ì‹¤ì œ ë‚´ìš©ìœ¼ë¡œ ì±„ì›€

path: "questions" : Session ìŠ¤í‚¤ë§ˆ ì•ˆì— ìˆëŠ” questions ë°°ì—´(ObjectId ì°¸ì¡° í•„ë“œ)ì„ ì‹¤ì œ Question ë¬¸ì„œë“¤ë¡œ ê°€ì ¸ì˜´

options.sort : ì§ˆë¬¸ì„ ì •ë ¬í•´ì„œ ê°€ì ¸ì˜¤ê¸°

{ isPinned: -1 } â†’ í•€ ê³ ì •ëœ ì§ˆë¬¸ ë¨¼ì €

{ createAt: 1 } â†’ ì‘ì„±ì¼ ì˜¤ë˜ëœ ê²ƒë¶€í„° (ë‹¨, ì—¬ê¸° ì˜¤íƒ€ ìˆìŒ â†’ createAt âŒ â†’ createdAt âœ… ë¡œ ì¨ì•¼ í•©ë‹ˆë‹¤)

2. ì„¸ì…˜ ì—†ì„ ê²½ìš°
if (!session) {
  return res
    .status(404)
    .json({ success: false, message: "Session not found" });
}


ì„¸ì…˜ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ 404 Not Found ë°˜í™˜

3. ì„¸ì…˜ ì‘ë‹µ ë°˜í™˜
res.status(200).json({ success: true, session });


ì„¸ì…˜ê³¼ ê·¸ ì•ˆì˜ ì§ˆë¬¸ë“¤ì„ JSONìœ¼ë¡œ ë°˜í™˜

í”„ë¡ íŠ¸ì—”ë“œëŠ” ì„¸ì…˜ ì •ë³´ + ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸ë¥¼ í•œ ë²ˆì— ë°›ì„ ìˆ˜ ìˆìŒ

4. ì—ëŸ¬ ì²˜ë¦¬
} catch (error) {
  res.status(500).json({ sucess: false, message: "Server Error" });
}


ì‹¤í–‰ ë„ì¤‘ ì˜¤ë¥˜ ë°œìƒ ì‹œ 500 Internal Server Error

âœ… ì •ë¦¬

ì´ APIëŠ”:
í´ë¼ì´ì–¸íŠ¸ê°€ GET /api/sessions/:id ìš”ì²­
ì„œë²„ëŠ” í•´ë‹¹ ì„¸ì…˜ì„ DBì—ì„œ ì°¾ìŒ
ì„¸ì…˜ + ì—°ê²°ëœ ì§ˆë¬¸ë“¤(populate)ì„ ê°€ì ¸ì˜´
ì •ë ¬: í•€ ì§ˆë¬¸ ë¨¼ì €, ì‘ì„±ì¼ ìˆœìœ¼ë¡œ
JSONìœ¼ë¡œ ë°˜í™˜

---
---
---

### 3.essionController.js_deleteSession
ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ë§Œë“  ì„¸ì…˜ì¸ì§€ í™•ì¸ â†’ ì„¸ì…˜ì— ì—°ê²°ëœ ì§ˆë¬¸ë“¤ ë¨¼ì € ì‚­ì œ â†’ ë§ˆì§€ë§‰ìœ¼ë¡œ ì„¸ì…˜ ì‚­ì œ íë¦„ì„ ì²˜ë¦¬í•©ë‹ˆë‹¤.

ğŸ” ì½”ë“œ í•´ì„
exports.deleteSession = async (req, res) => {
  try {
    // 1. ì„¸ì…˜ ì°¾ê¸°
    const session = await Session.findById(req.params.id);

    if (!session) {
      return res.status(404).json({ message: "ì„¸ì…˜ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤" });
    }


req.params.id : URLì—ì„œ ì „ë‹¬ëœ ì„¸ì…˜ ID
DBì—ì„œ ì„¸ì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
ì—†ìœ¼ë©´ 404 Not Found ë°˜í™˜

    // 2. ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì„¸ì…˜ì˜ ì†Œìœ ìì¸ì§€ í™•ì¸
    if (session.user.toString() !== req.user.id) {
      return res
        .status(401)
        .json({ message: "Not authorized to delete this session" });
    }


session.user : ì„¸ì…˜ ë¬¸ì„œì— ì €ì¥ëœ user(ObjectId)
req.user.id : ì¸ì¦ ë¯¸ë“¤ì›¨ì–´(protect)ê°€ ë„£ì–´ì¤€ ë¡œê·¸ì¸í•œ ì‚¬ìš©ì ID
ë‘ ê°’ì´ ë‹¤ë¥´ë©´ â†’ ë‚¨ì˜ ì„¸ì…˜ì„ ì§€ìš°ë ¤ëŠ” ì‹œë„ì´ë¯€ë¡œ 401 Unauthorized ë°˜í™˜

    // 3. ë¨¼ì € ì—°ê²°ëœ ëª¨ë“  ì§ˆë¬¸ ì‚­ì œ
    await Question.deleteMany({ session: session._id });


í•´ë‹¹ ì„¸ì…˜ê³¼ ì—°ê²°ëœ ëª¨ë“  Question ë¬¸ì„œë¥¼ DBì—ì„œ ì‚­ì œ
ì„¸ì…˜ë§Œ ì§€ìš°ë©´ orphan ë°ì´í„°(ê³ ì•„ ë ˆì½”ë“œ)ê°€ ë‚¨ìœ¼ë¯€ë¡œ ë¨¼ì € ì •ë¦¬

    // 4. ì„¸ì…˜ ì‚­ì œ
    await session.deleteOne();

    res.status(200).json({ message: "Session deleted successfully" });


ì„¸ì…˜ ë¬¸ì„œ ìì²´ë¥¼ ì‚­ì œ
ì„±ê³µí•˜ë©´ 200 OK ì™€ ë©”ì‹œì§€ ë°˜í™˜

  } catch (error) {
    res.status(500).json({ success: false, message: "Server Error" });
  }
};
ì‹¤í–‰ ë„ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ 500 Internal Server Error ë°˜í™˜


âœ… ì •ë¦¬

ì´ APIëŠ” ì„¸ì…˜ ì‚­ì œ ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ:
ì„¸ì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ â†’ ì—†ìœ¼ë©´ 404
ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì„¸ì…˜ì˜ ì£¼ì¸ì¸ì§€ í™•ì¸ â†’ ì•„ë‹ˆë©´ 401
ì—°ê²°ëœ ì§ˆë¬¸(Question)ë“¤ì„ ëª¨ë‘ ì‚­ì œ
ë§ˆì§€ë§‰ìœ¼ë¡œ ì„¸ì…˜ ì‚­ì œ
ì„±ê³µí•˜ë©´ 200 ì‘ë‹µ
